<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Chatbot</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background: #f5f7fa;
      }
      .chat-container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }
      .chat-header {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 20px;
        text-align: center;
      }
      .chat-messages {
        height: 400px;
        overflow-y: auto;
        padding: 20px;
      }
      .message {
        margin-bottom: 15px;
      }
      .message.user .message-text {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        margin-left: 50px;
      }
      .message.bot .message-text {
        background: #f8f9fa;
        color: #333;
        margin-right: 50px;
        border: 1px solid #e9ecef;
      }
      .message-text {
        padding: 12px 16px;
        border-radius: 18px;
        line-height: 1.6;
        word-wrap: break-word;
      }
      .message-time {
        font-size: 0.75rem;
        color: #999;
        margin-top: 5px;
      }
      .user .message-time {
        text-align: right;
      }
      .chat-input-container {
        padding: 20px;
        border-top: 1px solid #eee;
        display: flex;
        gap: 10px;
      }
      .chat-input {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid #ddd;
        border-radius: 25px;
        outline: none;
      }
      .send-btn {
        padding: 12px 20px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        border-radius: 25px;
        cursor: pointer;
      }
      .send-btn:hover {
        opacity: 0.9;
      }
    </style>
  </head>
  <body>
    <div class="chat-container">
      <div class="chat-header">
        <h2>ğŸ¤– Test Chatbot</h2>
        <p>Basit test versiyonu</p>
      </div>
      <div class="chat-messages" id="chatMessages">
        <div class="message bot">
          <div class="message-text">
            Merhaba! Test chatbot'una hoÅŸ geldiniz! ğŸ‰<br /><br />
            <strong>Test edebileceÄŸiniz komutlar:</strong><br />
            ğŸ”§ <strong>ER21</strong> - ST542 reset talimatÄ±<br />
            ğŸ”§ <strong>AL003</strong> - Carel reset talimatÄ±<br />
            â“ <strong>antifriz</strong> - FAQ cevabÄ±<br />
            ğŸ› ï¸ <strong>reset</strong> - Reset seÃ§enekleri<br />
            ğŸ’¬ <strong>merhaba</strong> - Genel yanÄ±t
          </div>
          <div class="message-time">10:32</div>
        </div>
      </div>
      <div class="chat-input-container">
        <input
          type="text"
          id="chatInput"
          class="chat-input"
          placeholder="MesajÄ±nÄ±zÄ± yazÄ±n..."
          onkeypress="if(event.key==='Enter') sendMessage()"
        />
        <button class="send-btn" onclick="sendMessage()">GÃ¶nder</button>
      </div>
    </div>

    <script>
      class TestChatbot {
        constructor() {
          this.chatMessages = document.getElementById("chatMessages");
          this.chatInput = document.getElementById("chatInput");

          // Test data
          this.faqData = {
            antifriz:
              "Antifriz, soÄŸutma sisteminin donmasÄ±nÄ± Ã¶nler. DÃ¼zenli olarak kontrol edilmeli ve gerektiÄŸinde deÄŸiÅŸtirilmelidir.",
            bypass:
              "Bypass sistemi, debinin ayarlanmasÄ±nda kullanÄ±lÄ±r. DoÄŸru ayar iÃ§in teknik servise baÅŸvurun.",
            bakÄ±m:
              "Periyodik bakÄ±m Ã§ok Ã¶nemlidir. YÄ±lda en az 2 kez profesyonel bakÄ±m yaptÄ±rÄ±n.",
          };

          this.resetInstructions = {
            st542:
              "**ST542 Reset TalimatlarÄ±**\n\n**AdÄ±m 1:** CihazÄ± kapatÄ±n\n**AdÄ±m 2:** SET + UP butonlarÄ±nÄ± 5 saniye basÄ±lÄ± tutun\n**AdÄ±m 3:** DOWN ile onaylayÄ±n\n\nâš ï¸ Reset sonrasÄ± ayarlarÄ± kontrol edin.",
            carel:
              "**Carel Reset TalimatlarÄ±**\n\n**AdÄ±m 1:** MENU butonuna 3 saniye basÄ±n\n**AdÄ±m 2:** rSt parametresini bulun\n**AdÄ±m 3:** YES olarak ayarlayÄ±n\n\nâš ï¸ Reset sonrasÄ± cihaz yeniden baÅŸlar.",
          };

          this.errorCodes = {
            er21: "st542",
            er01: "st542",
            er02: "st542",
            al003: "carel",
            al032: "carel",
            al30: "carel",
          };
        }

        addMessage(message, sender) {
          const messageDiv = document.createElement("div");
          messageDiv.className = `message ${sender}`;

          const formattedMessage = message
            .replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>")
            .replace(/\n/g, "<br>")
            .replace(/ğŸ”§/g, '<span style="color: #667eea;">ğŸ”§</span>')
            .replace(/â“/g, '<span style="color: #f093fb;">â“</span>')
            .replace(/ğŸ› ï¸/g, '<span style="color: #4facfe;">ğŸ› ï¸</span>')
            .replace(/âš ï¸/g, '<span style="color: #f5576c;">âš ï¸</span>');

          messageDiv.innerHTML = `
                    <div class="message-text">${formattedMessage}</div>
                    <div class="message-time">${new Date().toLocaleTimeString(
                      "tr-TR",
                      { hour: "2-digit", minute: "2-digit" }
                    )}</div>
                `;

          this.chatMessages.appendChild(messageDiv);
          this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
        }

        processMessage(message) {
          const lowerMessage = message.toLowerCase();

          // Hata kodu kontrolÃ¼
          for (const [code, type] of Object.entries(this.errorCodes)) {
            if (lowerMessage.includes(code)) {
              return this.resetInstructions[type];
            }
          }

          // FAQ kontrolÃ¼
          for (const [keyword, answer] of Object.entries(this.faqData)) {
            if (lowerMessage.includes(keyword)) {
              return `**${keyword.toUpperCase()} HakkÄ±nda**\n\n${answer}`;
            }
          }

          // Reset kontrolÃ¼
          if (lowerMessage.includes("reset")) {
            return 'Reset iÅŸlemi iÃ§in cihaz modelini belirtin:\n\nğŸ”¹ **ST542** iÃ§in: "ER21" veya "ST542"\nğŸ”¹ **Carel** iÃ§in: "AL003" veya "Carel"';
          }

          // Genel yanÄ±t
          return `Merhaba! Size nasÄ±l yardÄ±mcÄ± olabilirim?\n\nğŸ”§ **Hata kodlarÄ±:** ER21, AL003 gibi\nâ“ **Genel sorular:** antifriz, bypass, bakÄ±m\nğŸ› ï¸ **Reset:** "reset" yazÄ±n`;
        }
      }

      const chatbot = new TestChatbot();

      function sendMessage() {
        const message = chatbot.chatInput.value.trim();
        if (!message) return;

        // KullanÄ±cÄ± mesajÄ±nÄ± ekle
        chatbot.addMessage(message, "user");
        chatbot.chatInput.value = "";

        // Bot yanÄ±tÄ±nÄ± oluÅŸtur ve ekle
        setTimeout(() => {
          const response = chatbot.processMessage(message);
          chatbot.addMessage(response, "bot");
        }, 500);
      }
    </script>
  </body>
</html>
